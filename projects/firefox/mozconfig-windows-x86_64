CROSS_COMPILE=1

ac_add_options --enable-application=browser
ac_add_options --target=x86_64-w64-mingw32
ac_add_options --with-toolchain-prefix=x86_64-w64-mingw32-
ac_add_options --enable-default-toolkit=cairo-windows
mk_add_options MOZ_OBJDIR=@TOPSRCDIR@/obj-mingw
mk_add_options MOZ_APP_DISPLAYNAME="Tor Browser"
mk_add_options MOZILLA_OFFICIAL=1
mk_add_options BUILD_OFFICIAL=1

ac_add_options --enable-debug
ac_add_options --enable-optimize
ac_add_options --enable-strip
ac_add_options --enable-official-branding

#ac_add_options --enable-tor-browser-update
#ac_add_options --enable-signmar
#ac_add_options --enable-verify-mar

# Let's make sure no preference is enabling either Adobe's or Google's CDM.
ac_add_options --disable-eme
ac_add_options --disable-crashreporter
ac_add_options --disable-maintenance-service
ac_add_options --disable-webrtc
ac_add_options --disable-tests
ac_add_options --disable-stylo # Bugzilla 1390583
ac_add_options --disable-accessibility # https://sourceforge.net/p/mingw-w64/bugs/648/
ac_add_options --disable-jemalloc # Bugzilla 1466192

CXXFLAGS="$CXXFLAGS -ffunction-sections -fdata-sections -DWIDL_EXPLICIT_AGGREGATE_RETURNS"
LDFLAGS="$LDFLAGS -Wl,--gc-sections"
ac_add_options --disable-sandbox


#  -ffunction-sections + -fdata-sections + -Wl,--gc-sections - crash
#  -ffunction-sections + -Wl,--gc-sections - crash
#  -Wl,--gc-sections - crash
#  -ffunction-sections + -fdata-sections - no crash